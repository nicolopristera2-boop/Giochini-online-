<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Game</title>
    <style>
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); /* Sfondo Gradiente */
            color: white; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
        }
        
        .back-btn { position: absolute; top: 20px; left: 20px; color: rgba(255,255,255,0.7); text-decoration: none; font-weight: bold; transition: 0.3s; }
        .back-btn:hover { color: white; transform: translateX(5px); }

        .header { margin-top: 30px; text-align: center; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        h1 { font-size: 2.5rem; margin-bottom: 10px; }
        
        .game-info { 
            display: flex; gap: 30px; margin: 20px 0; font-size: 1.2rem; 
            background: rgba(0,0,0,0.2); padding: 10px 20px; border-radius: 20px;
        }
        
        .grid { 
            display: grid; 
            grid-template-columns: repeat(4, 1fr); 
            gap: 15px; 
            max-width: 600px; 
            margin: 0 auto; 
            perspective: 1000px; /* Necessario per effetto 3D */
        }
        
        .card { 
            width: 90px; height: 90px; 
            position: relative; 
            transform-style: preserve-3d; 
            transition: transform 0.5s; 
            cursor: pointer; 
        }

        .card:active { transform: scale(0.95); }
        .card.flipped { transform: rotateY(180deg); }
        
        /* Facce della carta */
        .card-front, .card-back {
            position: absolute;
            width: 100%; height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        /* Retro della carta (quello che vedi prima di cliccare) */
        .card-front {
            background: #ffffff;
            color: #2a5298;
            font-size: 2.5rem; /* Icona '?' o logo */
            transform: rotateY(0deg); /* Questo √® il fronte visivo iniziale se non flippato? No, correggiamo logica sotto */
            /* In realt√† in CSS flip logic: Front √® il retro, Back √® il contenuto */
            background: linear-gradient(45deg, #00d2ff, #3a7bd5);
        }
        
        /* Fronte della carta (l'emoji) */
        .card-back {
            background: white;
            color: #333;
            font-size: 3rem;
            transform: rotateY(180deg);
        }

        .card.matched .card-back { background-color: #2ecc71; color: white; }
        
        .btn-restart { 
            padding: 12px 25px; 
            background: #ff416c; 
            background: -webkit-linear-gradient(to right, #ff4b1f, #ff416c); 
            background: linear-gradient(to right, #ff4b1f, #ff416c); 
            color: white; 
            border: none; 
            border-radius: 50px; 
            font-size: 1rem; 
            cursor: pointer; 
            margin-top: 40px; 
            box-shadow: 0 4px 15px rgba(255, 65, 108, 0.4);
            transition: transform 0.2s;
        }
        .btn-restart:hover { transform: scale(1.05); }

    </style>
</head>
<body>

<a href="index.html" class="back-btn" data-i18n="backHome">üè† Home</a>

<div class="header">
    <h1 data-i18n="game3Title">Memory</h1>
    <div class="game-info">
        <span id="movesText"><span data-i18n="moves">Mosse: </span> <b><span id="moves">0</span></b></span>
        <span id="timeText"><span data-i18n="time">Tempo: </span> <b><span id="time">0</span>s</b></span>
    </div>
</div>

<div class="grid" id="grid"></div>

<button class="btn-restart" onclick="location.reload()" data-i18n="restartMsg">Ricomincia</button>

<script src="lingue.js"></script>
<script>
    window.isGamePage = true;

    const emojis = ['üöÄ','üöÄ','ü™ê','ü™ê','üëΩ','üëΩ','üå†','üå†','üõ∏','üõ∏','üåë','üåë','ü§ñ','ü§ñ','üåå','üåå'];
    let cards = [...emojis].sort(() => 0.5 - Math.random());
    
    let grid = document.getElementById('grid');
    let movesDisplay = document.getElementById('moves');
    let timeDisplay = document.getElementById('time');
    
    let flippedCards = [];
    let moves = 0;
    let timer;
    let seconds = 0;
    let matches = 0;
    let gameStarted = false;

    function startTimer() {
        if(gameStarted) return;
        gameStarted = true;
        timer = setInterval(() => {
            seconds++;
            timeDisplay.innerText = seconds;
        }, 1000);
    }

    // Creazione Griglia
    cards.forEach((emoji, index) => {
        let card = document.createElement('div');
        card.classList.add('card');
        card.dataset.emoji = emoji;
        
        // Struttura HTML per effetto Flip 3D
        // card-front √® il dorso blu, card-back √® l'emoji
        card.innerHTML = `
            <div class="card-front">‚ùì</div> 
            <div class="card-back">${emoji}</div>
        `;

        card.addEventListener('click', flipCard);
        grid.appendChild(card);
    });

    function flipCard() {
        if (!gameStarted) startTimer();
        
        let card = this;
        if (card.classList.contains('flipped') || flippedCards.length >= 2) return;

        card.classList.add('flipped');
        flippedCards.push(card);

        if (flippedCards.length === 2) {
            moves++;
            movesDisplay.innerText = moves;
            checkMatch();
        }
    }

    function checkMatch() {
        let [c1, c2] = flippedCards;
        
        if (c1.dataset.emoji === c2.dataset.emoji) {
            // Match!
            setTimeout(() => {
                c1.classList.add('matched');
                c2.classList.add('matched');
            }, 300); // Piccolo ritardo per vedere l'animazione
            
            flippedCards = [];
            matches++;
            
            if (matches === emojis.length / 2) {
                clearInterval(timer);
                setTimeout(() => alert(t('youWin') + "\n" + t('score') + moves), 500);
            }
        } else {
            // No Match
            setTimeout(() => {
                c1.classList.remove('flipped');
                c2.classList.remove('flipped');
                flippedCards = [];
            }, 1000);
        }
    }
</script>

</body>
</html>
